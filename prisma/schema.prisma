generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Allegato {
  id             BigInt        @id @default(autoincrement())
  contenuto      Bytes
  dimensione     BigInt?
  idSegnalazione Int?
  codiceAzienda  String?
  Azienda        Azienda?      @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Segnalazione   Segnalazione? @relation(fields: [idSegnalazione], references: [id], onDelete: Cascade)
}

model Avviso {
  id            BigInt    @id @default(autoincrement())
  titolo        String    @db.VarChar
  descrizione   String?
  dataCreazione DateTime? @default(now()) @db.Date
  matricola     String?   @db.VarChar
  codiceAzienda String?
  Azienda       Azienda?  @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Utente        Utente?   @relation(fields: [matricola], references: [matricola], onDelete: NoAction, onUpdate: NoAction)
}

model Azienda {
  codiceAzienda  String           @id @db.VarChar
  partitaIva     String           @db.VarChar
  ragioneSociale String?          @db.VarChar
  sede           String?          @db.VarChar
  recapito       String?          @db.VarChar
  Allegato       Allegato[]
  Avviso         Avviso[]
  Documentazione Documentazione[]
  Domanda        Domanda[]
  Formazione     Formazione[]
  Quiz           Quiz[]
  Risorsa        Risorsa[]
  Segnalazione   Segnalazione[]
  Utente         Utente[]
  VideoCorso     VideoCorso[]
}

model Documentazione {
  id            BigInt      @id @default(autoincrement())
  nome          String      @db.VarChar
  descrizione   String?     @db.VarChar
  contenuto     Bytes?
  formazione    BigInt?
  risorsa       BigInt?
  codiceAzienda String?
  Azienda       Azienda?    @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Formazione    Formazione? @relation(fields: [formazione], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Risorsa       Risorsa?    @relation(fields: [risorsa], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Formazione {
  id                 BigInt               @id @default(autoincrement())
  numeroCorsi        BigInt
  argomento          String?              @db.VarChar
  codiceAzienda      String?
  Documentazione     Documentazione[]
  Azienda            Azienda?             @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  GestioneFormazione GestioneFormazione[]
  Quiz               Quiz[]
  VideoCorso         VideoCorso[]
}

model GestioneFormazione {
  id           BigInt     @default(autoincrement())
  idFormazione BigInt
  matricola    String     @db.VarChar
  stato        String?    @db.VarChar
  idQuiz       BigInt?
  Formazione   Formazione @relation(fields: [idFormazione], references: [id], onDelete: NoAction)
  Quiz         Quiz?      @relation(fields: [idQuiz], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Utente       Utente     @relation(fields: [matricola], references: [matricola], onDelete: NoAction)

  @@id([id, idFormazione, matricola])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model GestioneRisorsa {
  id                BigInt    @default(autoincrement())
  matricola         String    @db.VarChar
  risorsa           BigInt
  dataManutenzione  DateTime? @db.Date
  dataAggiornamento DateTime? @db.Date
  Utente            Utente    @relation(fields: [matricola], references: [matricola], onDelete: NoAction, onUpdate: NoAction)
  Risorsa           Risorsa   @relation(fields: [risorsa], references: [id], onDelete: NoAction)

  @@id([id, matricola, risorsa])
}

model Quiz {
  id                 BigInt               @id @default(autoincrement())
  nome               String               @db.VarChar
  durata             BigInt?
  formazione         BigInt?
  codiceAzienda      String?
  Domanda            Domanda[]
  GestioneFormazione GestioneFormazione[]
  Azienda            Azienda?             @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Formazione         Formazione?          @relation(fields: [formazione], references: [id], onDelete: NoAction)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Risorsa {
  id              BigInt            @id @default(autoincrement())
  nome            String            @db.VarChar
  tipo            String?           @db.VarChar
  descrizione     String?           @db.VarChar
  stato           String?           @db.VarChar
  schedaAllegata  Bytes?
  codiceAzienda   String?
  Documentazione  Documentazione[]
  GestioneRisorsa GestioneRisorsa[]
  Azienda         Azienda?          @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Segnalazione    Segnalazione[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Segnalazione {
  id            Int        @id @default(autoincrement())
  titolo        String     @db.VarChar
  descrizione   String?    @db.VarChar
  risorsa       BigInt?
  matricola     String?    @db.VarChar
  dataCreazione DateTime?  @default(now()) @db.Date
  stato         String?
  priorita      String?    @db.VarChar
  codiceAzienda String?
  Allegato      Allegato[]
  Azienda       Azienda?   @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Utente        Utente?    @relation(fields: [matricola], references: [matricola], onDelete: NoAction)
  Risorsa       Risorsa?   @relation(fields: [risorsa], references: [id])
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Utente {
  matricola          String               @id @db.VarChar
  nome               String?              @db.VarChar
  cognome            String?              @db.VarChar
  dataNascita        DateTime?            @db.Date
  email              String?              @db.VarChar
  password           String?              @db.VarChar
  ruolo              String?              @db.VarChar
  dataAssunzione     DateTime?            @db.Date
  codiceAzienda      String?              @db.VarChar
  Avviso             Avviso[]
  GestioneFormazione GestioneFormazione[]
  GestioneRisorsa    GestioneRisorsa[]
  Segnalazione       Segnalazione[]
  Azienda            Azienda?             @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
}

model VideoCorso {
  id            BigInt      @id @default(autoincrement())
  nome          String      @db.VarChar
  durata        BigInt?
  descrizione   String?     @db.VarChar
  stato         String?     @db.VarChar
  url           String      @db.VarChar
  formazione    BigInt?
  codiceAzienda String?     @db.VarChar
  Azienda       Azienda?    @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Formazione    Formazione? @relation(fields: [formazione], references: [id], onDelete: NoAction)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Domanda {
  id               Decimal  @id @db.Decimal
  descerizione     String
  rispostaCorretta Boolean?
  codiceAzienda    String?  @db.VarChar
  idQuiz           BigInt?
  Azienda          Azienda? @relation(fields: [codiceAzienda], references: [codiceAzienda], onDelete: NoAction, onUpdate: NoAction)
  Quiz             Quiz?    @relation(fields: [idQuiz], references: [id], onDelete: NoAction, onUpdate: NoAction)
}
